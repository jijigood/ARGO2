# Pareto实验优化配置 V3
# ==========================================
# 目标：进一步优化参数，使成本-质量权衡更明显
#
# 优化策略：
# 1. 进一步增加成本参数，使成本影响更大
# 2. 调整效率比，使检索在高μ时也有一定吸引力
# 3. 降低p_s，增加检索不确定性
# 4. 预期：使中μ值也有不同行为，成本变化更明显
# ==========================================

gpu:
  n_gpus: 8
  max_memory_per_gpu: 10
  default_gpu_ids: [4, 5, 6, 7]
  default_mode: "auto"

models:
  small:
    models:
      - "Qwen/Qwen2.5-1.5B-Instruct"
      - "Qwen/Qwen2.5-3B-Instruct"
    recommended_mode: "single"
    n_gpus_needed: 1

mdp:
  # 状态空间
  U_max: 1.0
  
  # ========================================
  # 进一步优化的状态转移参数
  # ========================================
  # 设计原则：
  # - 增加delta_r，使检索更有吸引力
  # - 保持delta_p，使效率比更接近
  # - 降低p_s，增加检索不确定性
  #
  delta_r: 0.20       # 检索进度增量 (从0.18增加11%，使检索更有吸引力)
  delta_p: 0.06       # 推理进度增量 (保持不变)
  
  # 检索成功率 - 进一步降低以增加不确定性
  p_s: 0.60           # 检索成功概率 (从0.65降低到0.60，增加8%)
  
  # ========================================
  # 进一步增加的成本参数
  # ========================================
  # 设计原则：
  # - 进一步增加成本参数，使成本影响更大
  # - 保持c_r/c_p = 4.0的比例
  # - 使成本变化更明显
  #
  c_r: 0.16           # 检索成本 (从0.12增加33%)
  c_p: 0.04           # 推理成本 (从0.03增加33%)
  
  # ========================================
  # 效率分析（新参数）
  # ========================================
  # 检索效率 = E[delta_r] / c_r = 0.60 × 0.20 / 0.16 = 0.75
  # 推理效率 = delta_p / c_p = 0.06 / 0.04 = 1.5
  # 
  # 变化（相对于v2）：
  # - 检索效率从0.975降低到0.75（降低23%）
  # - 推理效率从2.0降低到1.5（降低25%）
  # - 效率比从2.05降低到2.0（更接近）
  #
  # 预期行为：
  # - 低μ: 偏好检索（但成本更高）
  # - 中μ: 更容易在检索和推理之间切换（效率比更接近）
  # - 高μ: 更早切换到推理，但可能仍有一些检索（因为效率比更接近）
  
  # MDP求解参数
  mu: 0.5             # 默认值 (实验时会扫描)
  gamma: 0.98         # 折扣因子
  grid_size: 101      # U的离散化粒度
  
  # 质量函数
  quality_function: "linear"
  quality_k: 1.0
  
  # Reward Shaping
  reward_shaping:
    enabled: false
    k: 1.0

inference:
  batch_size: 4
  generation:
    max_new_tokens: 10
    temperature: 0.1
    do_sample: false
  dtype: "float16"

output:
  results_dir: "results/pareto_optimized_v3"
  save_full_results: true
  verbose: true
