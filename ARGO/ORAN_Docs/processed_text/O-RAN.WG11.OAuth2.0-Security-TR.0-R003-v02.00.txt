Contents
List of figures	3
List of tables	3
Foreword	4
Modal verbs terminology	4
1	Scope	5
1.1 	Consideration	5
2	References	5
2.1 	Informative references	5
3	Definition of terms, symbols and abbreviations	6
3.1	Terms	6
3.2	Symbols	7
3.3	Abbreviations	7
4	Study and recommendation from IETF, 3GPP and ETSI On OAuth 2.0	8
4.1 	General	8
4.2 	IETF 6749	8
4.3 	IETF 8705	8
4.4 	3GPP TS 33.122	8
4.5 	ETSI NFV SEC022	8
5	Threats	8
5.1	O-RAN Elements & Interfaces	8
5.2 	Threats Template	8
5.3 	Potential Threat and Exploits	9
5.4 	OAuth 2.0 Threats	9
6	Threat Analysis	10
6.1	 General OAuth 2.0 Threats	10
7	Risk Assessment	18
8	Security Controls	18
9	OAuth 2.0 Authorization framework	18
9.1 	Overview	19
9.2	Key Issues	19
9.3	Solutions	21
9.3.1   	  Solution #1: Registration of  rApp	21
9.3.2   	  Solution #2: Request access token for R1 services	23
9.3.3   	  Solution #3: R1 services request with access token	25
10	Study and recommendation an O-RAN Authorization Server architecture	28
11	Conclusion	28
Revision history		29
List of figures
Figure 9.1-1: OAuth 2.0 framework for O-RAN Architecture elements and applications	19
Figure 9.3-1: rApp Registration use case sequence diagram	22
Figure 9.3-2: Request access token for R1 services use case sequence diagram 	24
Figure 9.3-3: R1 Service request using access token use case sequence diagram	26
List of tables
Table 5.4-1: OAuth 2.0 Threats	9
Table 9.3-1: rApp Registration use case	22
Table 9.3-2: Request access token for R1 services use case	24
Table 9.3-3: R1 Service request using access token use case 	26
Foreword
This Technical Report (TR) has been produced by O-RAN Alliance.
Modal verbs terminology
In the present document "shall", "shall not", "should", "should not", "may", "need not", "will", "will not", "can" and "cannot" are to be interpreted as described in clause 3.2 of the O-RAN Drafting Rules (Verbal forms for the expression of provisions).
"must" and "must not" are NOT allowed in O-RAN deliverables except when used in direct citation.
1	Scope
The technical report defines the authorization framework for O-RAN elements using OAuth 2.0 and applies to the HTTP and Kafka based APIs [i.13][i.18] used in the R1, O1, O2, A1, FH m-plane[i.17] and Y1 interfaces.
For this objective, the present document
Defines the procedure flow for token registration process, token request process, token verification process and token authorization process. It will specify the token scope metadata for O-RAN.
Analyses the existing specifications related to OAuth 2.0 such as O-RAN Security protocol specification, IETF RFC 8705[i.6], IETF RFC 6749[i.5], 3GPP TS29.501[i.3], 3GPP TS 33.122[i.4] and ETSI NFV SEC-022[i.7]. This is used as input to the present document.
Analyses the security threat arising from the misuse of the access token and defines the security requirements associated to access token.
Provides the study and recommendation of an authorization server architecture to overlay on the O-RAN architecture.
1.1 	Consideration
This Technical Report makes the following considerations:
O-RAN Alliance WG1 has identified the key functions and interface [i.9] adopted in O-RAN and this will influence the set of assets to be protected for OAuth 2.0 framework.
This TR will perform a detailed study of the OAuth 2.0 Authorization server for O-RAN Architecture Elements and interface.
Clause 4.7 in O-RAN Security Protocol Security specification [i.1] will be considered as the baseline text for the OAuth 2.0 framework.
The recommended security requirements and controls provided in this report will be shared with the impacted O-RAN Alliance working group, such as WG1, WG2, WG3, WG6 and WG10 prior publishing them as normative.
2	References
2.1 	Informative references
References are either specific (identified by date of publication and/or edition number or version number) or non-specific. For specific references, only the cited version applies. For non-specific references, the latest version of the referenced document (including any amendments) applies.
NOTE:	While any hyperlinks included in this clause were valid at the time of publication, O-RAN cannot guarantee their long term validity.
The following referenced documents are not necessary for the application of the present document but they assist the user with regard to a particular subject area.
[i.1] O-RAN ALLIANCE TS: “O-RAN Security Protocols Specification”
[i.2] O-RAN ALLIANCE TS: “O-RAN Security Requirements and Controls Specification”
[i.3] 3GPP TS 29.501:"5G System; Network Function Repository Services".
[i.4] 3GPP TS 33.122:"Security aspects of Common API Framework (CAPIF) for 3GPP northbound APIs".
[i.5] IETF RFC 6749: "The OAuth 2.0 Authorization Framework".
[i.6] IETF RFC 8705: "OAuth 2.0 Mutual-TLS Client Authentication and Certificate-Bound Access Tokens".
[i.7] ETSI GS NFV-SEC 022: "Network Functions Virtualisation (NFV) Release 2;Security; Access Token
Specification for API Access".
[i.8] IETF RFC 6819 : “OAuth 2.0 Threat Model and Security Considerations”.
[i.9] O-RAN ALLIANCE TS : “O-RAN Architecture Description”.
[i.10]3GPP TS 23.222: "Common API Framework for 3GPP Northbound APIs".
[i.11]3GPP TS 29.222: "Common API Framework for 3GPP Northbound APIs".
[i.12] IETF RFC 2616: “Hypertext Transfer Protocol -- HTTP/1.1”
[i.13]   O-RAN TS: "R1 interface: General Aspects and Principles". ("R1GAP")
[i.14]   O-RAN TS: " Non-RT RIC & A1/R1 Interface: Use Cases and Requirements”. ("UCR")
[i.15] O-RAN TR: “Decoupled SMO”
[i.16] O-RAN TR: “SMO Security”
[i.17] O-RAN TS: “Management Plane Specification”
[i.18] Kafka Documentation https://kafka.apache.org/documentation.html
3	Definition of terms, symbols and abbreviations
3.1	Terms
For the purposes of the present document, the following terms apply:
A1: Interface between non-RT RIC and Near-RT RIC to enable policy-driven guidance of Near-RT RIC applications/functions, and support AI/ML workflow.
Access Token: credentials used to obtain access. It is a string, usually opaque to the client, representing an authorization issued to the client. Tokens represent specific scopes and durations of access, granted by the resource owner, and enforced by the resource server and authorization server (see [i.5], clause 1.4).
Authorization code: The authorization code is obtained by using an authorization server as an intermediary between the client and resource owner.  Instead of requesting authorization directly from the resource owner, the client directs the resource owner to an authorization server (via its user-agent as defined in [RFC2616]), which in turn directs the resource owner back to the client with the authorization code. ([i.5], clause 1.3.1)
Authorization Server: The server issuing access tokens to the client after successfully authenticating the resource owner and obtaining authorization. ([i.5], clause 1.1)
Client: An application making protected resource requests on behalf of the resource owner and with its authorization. The term "client" does not imply any particular implementation characteristics (e.g., whether the application executes on a server, a desktop, or other devices). ([i.5], clause 1.1)
Client Credentials: The client credentials (or other forms of client authentication) can be used as an authorization grant when the authorization scope is limited to the protected resources under the control of the client, or to protected resources previously arranged with the authorization server.  Client credentials are used as an authorization grant typically when the client is acting on its own behalf (the client is also the resource owner) or is requesting access to protected resources based on an authorization previously arranged with the authorization server. ([i.5], clause 1.3.4)
CSRF: Cross-site request forgery (CSRF) is a web-based attack whereby HTTP requests are transmitted from a user that the web site trusts or has authenticated (e.g., via HTTP redirects or HTML forms). ([i.8], clause 4.4.1.8)
Near-Real-Time RAN Intelligent Controller: An O-RAN Network Function (NF) that enables near-real-time control and optimization of RAN elements and resources via fine-grained data collection and actions over E2 interface. It may include AI/ML (Artificial Intelligence / Machine Learning) workflow including model training, inference and updates.
Non-Real-Time RAN Intelligent Controller: A functionality within SMO that drives the content carried across the A1 interface.  It is comprised of the Non-RT RIC Framework and the Non-RT RIC Applications (rApps) whose services are defined below.
Non-RT RIC Applications (rApps): Modular applications that leverage the functionality exposed via the Non-RT RIC Framework’s R1 interface to provide added value services relative to RAN operation, such as driving the A1 interface, recommending values and actions that may be subsequently applied over the O1/O2 interface and generating “enrichment information” for the use of other rApps.  The rApp functionality within the Non-RT RIC enables non-real-time control and optimization of RAN elements and resources and policy-based guidance to the applications/features in Near-RT RIC.
O2: Interface between SMO framework as specified in Clause 5.3.1 and the O-Cloud for supporting O-RAN virtual network functions. Please refer to [13] for more information.
Open Redirector: An open redirector is an endpoint using a parameter to automatically redirect a user-agent to the location specified by the parameter value without any validation. ([i.5], clause 10.15)
R1 Interface: Interface between rApps and Non-RT RIC Framework via which R1 Services can be produced and consumed.
Refresh token: Refresh tokens are credentials used to obtain access tokens.  Refresh tokens are issued to the client by the authorization server and are used to obtain a new access token when the current access token becomes invalid or expires, or to obtain additional access tokens with identical or narrower scope (access tokens may have a shorter lifetime and fewer permissions than authorized by the resource owner). ([i.5], clause 1.5)
Resource Owner: An entity capable of granting access to a protected resource. When the resource owner is a person, it is referred to as an end-user. ([i.5], clause 1.1)
Resource Server: The server hosting the protected resources, capable of accepting and responding to protected resource requests using access tokens. ([i.5], clause 1.1)
SMO: A Service Management and Orchestration framework.
User-Agent: The User-Agent request-header field contains information about the user agent originating the request. This is for statistical purposes, the tracing of protocol violations, and automated recognition of user agents for the sake of tailoring responses to avoid particular user agent limitations. ([i.12], clause 14.43)
xApp: An application designed to run on the Near-RT RIC. Such an application is likely to consist of one or more microservices and at the point of on-boarding will identify which data it consumes and which data it provides. The application is independent of the Near-RT RIC and may be provided by any third party. The E2 enables a direct association between the xApp and the RAN functionality.
Y1: An interface over which RAN analytics services are exposed by the Near-RT RIC to be consumed by Y1 consumers.
3.2	Symbols
For the purposes of the present document, the following symbols apply:
None
3.3	Abbreviations
For the purposes of the present document, the following abbreviations apply:
3GPP	3rd Generation Partnership Project
Near-RT RIC          Near-Real-Time RAN Intelligent Controller
rApp	Non-RT RIC Application
SMO	Service Management and Orchestration
xApp	Near-RT RIC Application
4	Study and recommendation from IETF, 3GPP and ETSI on OAuth 2.0
4.1 	General
4.2 	IETF 6749
Editor’s note: This clause will do the study related to OAuth 2.0 framework from IETF6749
4.3 	IETF 8705
Editor’s note: This clause will do the study related to OAuth 2.0 Mutual-TLS Client Authentication and Certificate-Bound Access Tokens from IETF8705
4.4 	3GPP TS 33.122
Editor’s note: This clause will do the study related to OAuth 2.0 recommended from 3GPP specification  (23.222, 29.222, 33.122, TS29.501)
4.5 	ETSI NFV SEC022
Editor’s note: This clause will do the study related to OAuth 2.0 mechanism and definition from ETSI NFV SEC022
5	Threats
5.1	O-RAN Elements & Interfaces
5.2 	Threats Template
Template to present the threat characteristics:
5.3 	Potential Threat and Exploits
5.4 	OAuth 2.0 Threats
The following threats to OAuth 2.0 have been identified and are analyzed in clause 6– Threat Analysis.
Table 5.4-1 – OAuth 2.0 Threats
6	Threat Analysis
6.1	 General OAuth 2.0 Threats
Editor Note: OAuth authorization sever was proposed for identified assets it may be changed based on study and recommendation performed in Clause 10 Study and recommendation an O-RAN Authorization Server architecture.
7	Risk Assessment
8	Security Controls
9	OAuth 2.0 Authorization framework
Editor’s note: This clause will discuss the authorization framework and its procedure flow such as token registration process, token request process, token verification process and token authorization process.  And also this clause will discuss the key issues, proposed solutions, limitations for O-RAN interfaces & elements and the current/future study for OAuth 2.0(network functions(each),etc).
9.1 	Overview
Figure 9.1 depicts the basic OAuth 2.0 framework for O-RAN Architecture elements and applications. This general authorization framework is generalized from clause 1 of IETF 6749 [i.5].
Figure 9.1-1 OAuth 2.0 framework for O-RAN Architecture elements and applications
O-RAN OAuth 2.0 framework defines four roles from clause 1 of IETF 6749 [i.5]:
O-RAN client: An O-RAN client is an O-RAN Architecture Element or Application like an rApp or xApp acting as an OAuth client.
Authorization server: The server issuing access tokens to the O-RAN client after successfully authenticating the resource owner and obtaining authorization.
Resource owner:   “An entity capable of granting access to a protected resource. When the resource owner is a person, it is referred to as an end-user.” ([i.5], clause 1.1)
Resource server:  “The server hosting the protected resources, capable of accepting and responding to protected resource requests using access tokens.” ([i.5], clause 1.1)
9.2	Key Issues
9.2.1   Key Issue #1: Registration of O-RAN Architecture Elements in OAuth Authorization Server
9.2.2  Key Issue #2: Provisioning of Client ID and secrets to O-RAN Architecture Elements
9.2.3  Key Issue #3: Provisioning of Authorization Grants for O-RAN Architecture Elements
9.2.4  Key Issue #4: Revocation of Client ID and secrets for O-RAN Architecture Elements
9.2.5  Key Issue #5: Revocation of Authorization Grants for O-RAN Architecture Elements
Key Issue #6 Secure transfer of client secrets to clients
9.2.6.1  Key issue detail
The need is to identify
How the client secrets are transferred to potential clients
Whether the client secrets will be known at development time or runtime?
9.2.6.2 Security threats
Key Issue #7: Secure transit and storage of access and refresh tokens
Key issue detail
It needs to be identified what possible mechanisms exists to ensure the integrity and confidentiality of access and refresh tokens.
Security threats
9.2.8  Key Issue #8: Defining expiration times for access tokens and client secrets
Key issue detail
It needs to be identified if
Access tokens need to be configured with the minimal expiration time and in what usecases
Client secrets needs to revoked and refreshed regularly and if so at what intervals
Security threats
9.2.9  Key Issue #9: Consumers based on Client_IDs created with valid administration
9.2.9.1 Key issue detail
It needs to be identified if
Consumers who connect are only those validated by administrators
Dynamic clients are possible or not
Security threats
Key Issue #10: Scope creation
9.2.10.1 Key issue detail
It needs to be checked as to how scopes are designed, provisioned and enforced. Key topics are
How scopes are designed by the resource servers including the clearance and access levels
How scopes are transferred the authorization server
How scopes are requested by the client
How scopes are created in the authorization server
9.2.10.2 Security threats
9.3	Solutions
9.3.1   			Solution #1: Registration of  rApp
9.3.1.1 Background
This use case allows an rApp to register to the SMO as specified in R1GAP [i.13][i.14]. The registration procedure is specified as part of Service Management and Exposure services in R1GAP [i.13][i.14].
9.3.1.2 Solution Description
Table 9.3-1 rApp Registration use case
Figure 9.3-1 rApp Registration use case sequence diagram
9.3.1.3	Impacts on Existing O-RAN Architecture Elements and Interfaces
R1 interface, rApp and SME  are  the O-RAN architecture elements and interfaces  involved in the proposed use cases as specified in Decoupled SMO [i.15][i.16].
1)	Service Management and Exposure (SME) SMOS
The SME service is introduced in the [i.8] section 3.1. While the SME was initially targeted for management and exposure of rApp services in the [i.8], its services are applicable to any entities within the SMO that fulfil the roles of Service Producer and/or Service Consumer.
In a decomposed service-based SMO architecture, the SME can be leveraged as a generic SMOS, handling service management and exposure for any SMOSs within SMO. The SME SMOS provides a set of common SMO capabilities that are needed for all SMO Services.
Several of the SME services are applicable to any SMOSs:
SMOS registration,
SMOS discovery,
Authentication and authorization to access a SMOS,
Communication support between SMOS Service Producers and SMOS Service Consumers (SMOS Communication),
Bootstrap of new SMOSs (optional),
Heartbeat of SMOSs (optional).
rApp Management (SMOS)
The rApp management service handles management aspects specific to rApps such as:
rApp Configuration Management (CM): enables management of the rApp configuration settings,
rApp Performance Management (PM): offers support for performance reporting on an rApp performance, or of the rApp communication with the non-RT RIC framework (rApp usage of R1 interface),
rApp Fault Management (FM): provides the fault reporting capabilities to rApps, so they can consume it to report faults that are related to the rApp, or to the rApp communication with the non-RT RIC framework (rApp usage of R1 interface),
rApp Logging Information: enables rApps to convey their logging information to the non-RT RIC framework,
rApp lifecycle management services, that expose services that allow to trigger rApp software lifecycle management.
9.3.1.4	Solution Evaluation
Key Issue #1: Registration of O-RAN Architecture Elements in OAuth Authorization Server
9.3.1.5	Potential Security Recommendations
OAuth protection of the R1 interface is already mandatory in the O-RAN Security Requirements and Controls Specifications [i.2] SEC-CTL-R1-3.
9.3.2   			Solution #2: Request access token for R1 services
9.3.2.1 Background
This use case allows an rApp to request an access token for access to R1 services as specified in R1GAP [i.13][i.14]. The request access procedure is specified as part of Service Management and Exposure services in R1GAP [i.13][i.14].
An rApp in the role of Service Consumer will be able to request the token and once the token is available, the rApp in the role of Service Consumer will be able access the R1 Services for which it has been authorized.
9.3.2.2	Solution Description
Table 9.3-2 Request access token for R1 services use case
Figure 9.3-2 Request access token for R1 services use case sequence diagram
9.3.2.3	Impacts on Existing O-RAN Architecture Elements and Interfaces
R1 interface, rApp and SME  are  the O-RAN architecture elements and interfaces  involved in the proposed use cases as specified in Decoupled SMO [i.15][i.16].
1)	Service Management and Exposure (SME) SMOS
The SME service is introduced in the [i.8] section 3.1. While the SME was initially targeted for management and exposure of rApp services in the [i.8], its services are applicable to any entities within the SMO that fulfil the roles of Service Producer and/or Service Consumer.
In a decomposed service-based SMO architecture, the SME can be leveraged as a generic SMOS, handling service management and exposure for any SMOSs within SMO. The SME SMOS provides a set of common SMO capabilities that are needed for all SMO Services. Several of the SME services are applicable to any SMOSs:
SMOS registration,
SMOS discovery,
Authentication and authorization to access a SMOS,
Communication support between SMOS Service Producers and SMOS Service Consumers (SMOS Communication),
Bootstrap of new SMOSs (optional),
Heartbeat of SMOSs (optional).
2) SME functions in the role of SME services Producer
supports the functionality of OAuth 2.0 Authorization server,
support authentication and authorization of an rApp to determine which R1 services an rApp can access,
provide response of success or failure to access token request.
rApp
supports initiating the procedure to request access token,
supports initiating service request with the available access token.
9.3.2.4	Solution Evaluation
Key Issue #3: Provisioning of Authorization Grants for R1 services
9.3.2.5	Potential Security Recommendation
Use OAuth 2.0, as specified in O-RAN Security Protocols Specifications [i.1],  clause 4.7 to implement authorization in the R1 interface.
Enable rApp to request OAuth 2.0 access tokens for R1 services.
Enable the SME to act as both an OAuth 2.0 resource and an OAuth 2.0 Authorization server.
9.3.3   			Solution #3: R1 services request with access token
9.3.3.1 Background
This use case  discuss R1 service Producer to verify that rApp is authorized to access the R1 service as specified in R1GAP [i.13][i.14]. The service request procedure is specified as part of Service Management and Exposure services in R1GAP [i.13][i.14].
9.3.3.2	Solution Description
Table 9.3-3 R1 Service request using access token use case
Figure 9.3-3 R1 Service request using access token use case  sequence diagram
Editor Notes: “whether or not it is required for all API accesses to go through the SME need to be discussed further”.
9.3.3.3	Impacts on Existing O-RAN Architecture Elements and Interfaces
R1 interface, rApp and SME are  the O-RAN architecture elements and interfaces  involved in the proposed use cases as specified in Decoupled SMO [i.15][i.16].
1)	Service Management and Exposure (SME) SMOS
The SME service is introduced in the [i.13] section 3.1. While the SME was initially targeted for management and exposure of rApp services in the [i.13], its services are applicable to any entities within the SMO that fulfil the roles of Service Producer and/or Service Consumer.
In a decomposed service-based SMO architecture, the SME can be leveraged as a generic SMOS, handling service management and exposure for any SMOSs within SMO. The SME SMOS provides a set of common SMO capabilities that are needed for all SMO Services.
Several of the SME services are applicable to any SMOSs:
SMOS registration,
SMOS discovery,
Authentication and authorization to access a SMOS,
Communication support between SMOS Service Producers and SMOS Service Consumers (SMOS Communication),
Bootstrap of new SMOSs (optional),
Heartbeat of SMOSs (optional).
SME in the role of SME services Producer
supports the functionality of OAuth 2.0 Authorization server,
support authentication and authorization of an rApp to determine which R1 services an rApp can access,
provide response of success or failure to access token request
rApp
initiating the procedure to request access token,
initiating service request with the available access token.
R1 Service Producer
provider of an R1 service.
9.3.3.4   Solution Evaluation
Key issue #6: Provisioning of service access based on access token
Potential Security Recommendations
Use OAuth 2.0, as specified in O-RAN Security Protocols Specifications [3], clause 4.7 to implement authorization in the R1 interface.
Enable the SME to act as both an OAuth 2.0 resource and an OAuth 2.0 Authorization server.
10	Study and recommendation an O-RAN Authorization Server architecture
Editor’s note: This section will do a study and recommendation on an authorization server architecture to overlay on the O-RAN architecture.
11	Conclusion
Editor’s note : This clause will provide the summary for the TR and mapping tables the key issues and solutions and it will submit the recommendations to WG1 for O-RAN Authorization server.
Revision history