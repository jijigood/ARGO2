O-RAN.WG11.Security-Log-Management-TR.0-R003-v01.00

     O-RAN.WG11.Security-Log-Management-TR.0-R003-v01.00

Technical Report

O-RAN Working Group 11 (Security Work Group)

Study on Security Log Management

Copyright © 2023 by the O-RAN ALLIANCE e.V.

The copying or incorporation into any other work of part or all of the material available in this document in any form without the prior written permission of O-RAN ALLIANCE e.V.  is prohibited, save that you may print or download extracts of the material of this document for your personal use, or copy the material of this document for the purpose of sending to individual third parties for their information provided that you acknowledge O-RAN ALLIANCE as the source of the material and that you inform the third party that these conditions apply to them and that they must comply with them.

O-RAN ALLIANCE e.V., Buschkauler Weg 27, 53347 Alfter, Germany

Contents

Contents	2

List of figures	4

List of tables	4

Foreword	5

Modal verbs terminology	5

Introduction	5

1	Scope	6

2	References	6

2.1	Informative references	6

3	Definitions and abbreviations	8

3.1	Definitions	8

3.2	Abbreviations	8

4	Secure Log Management background, concepts and assumptions	10

4.1	Introduction	10

4.2	Definition of Event Sources	11

4.3	Security Log Data Lifecycle Management	12

5	Key Issues	12

5.1	Introduction	12

5.2	Security logs contents	13

5.2.1	Key Issue SLC#1: Logging all Security related activity and events.	13

5.2.2	Key Issue SLC#2: Log Authentication Attempts	16

5.2.3	Key Issue SLC#3: Log Encryption Configuration Information	16

5.2.4	Key Issue SLC#4: Logging accesses to personal data	16

5.2.5	Key Issue SLC#5: Logging Events Related to the Master Clock	17

5.2.6	Key Issue SLC#6: Logging details of xApps	17

5.2.7	Key Issue SLC#7: Logging details of rApps	17

5.2.8	Key Issue SLC#8: Logging details of VNF/CNF	17

5.2.9	Key Issue SLC#9: Logging information of dynamically loaded libraries	17

5.2.10	Key Issue SLC#10: Logging accesses to ML training data	17

5.2.11	Key Issue SLC#11: No differentiation between M2M and human interfaces	17

5.2.12	Key Issue SLC#12: Logging the identity of the person or process that originated the request, response, or the entity that originated the log message in the metadata	17

5.2.13	Key Issue SLC#13: Maintaining unique system references in the logs	18

5.2.14	Key Issue SLC#14: Synchronisation of logs using common time sources	18

5.2.15	Key issue SLC#15: Emergency calls related logs	18

5.2.16	Key issue SLC#16:  Logging details of O-Cloud	18

5.3	Security logs transfer mechanisms	20

5.3.1	Key Issue SLTM#1: Secure Storage at Rest	20

5.3.2	Key Issue SLTM#2: Study Security Logging best practices of ONAP Project	20

5.3.3	Key Issue SLTM#3: Secure transfer protocols	20

5.4	Security logs formats	20

5.4.1	Key Issue SLF#1: Standardized logging metadata to support security analytics	20

5.4.2	Key Issue SLF#2: Logging the field “date/time” in the metadata of the security audit logs.	22

5.4.3	Key Issue SLF#3: Standardized logging format	22

5.5	Log Management Security Framework	22

6	Mitigations and Solutions	24

6.1	Introduction	24

6.2	Solution #1:	24

6.1.1	Introduction	24

6.1.2	Solution details	24

6.1.3	Evaluation	24

7	Conclusions	25

7.1	Key Issue Solution Mapping	25

7.1.1	Security logs contents	25

7.1.2	Security logs transfer mechanisms	26

7.1.3	Security logs formats	26

7.2	Alignment to other studies	26

7.2.1	Application Lifecycle Management Security	26

8	Recommendations	27

9	History	27

List of figures

	Figure 1 - Security Log Management Schema	6

	Figure 41 Log-management architecture	10

	Figure 42 Definition of Asset	11

	Figure 3 – Security Event Entry	21

List of tables

	Table 1: Cloud Services vs. Event Sources (Overview)	11

	Table 2 - Application LCM Logging Events	27

Foreword

This Technical Report (TR) has been produced by the O-RAN Alliance.

Modal verbs terminology

In the present document "shall", "shall not", "should", "should not", "may", "need not", "will", "will not", "can" and "cannot" are to be interpreted as described in clause 3.2 of the O-RAN Drafting Rules (Verbal forms for the expression of provisions).

"must" and "must not" are NOT allowed in O-RAN deliverables except when used in direct citation.

Introduction

This Work Item is needed to address the Security Log Management across the entire O-RAN architecture.

Security Log Management has not been part of O-RAN specifications yet, although the term FCAPS (Fault, Configuration, Accounting, Performance, Security) has been used in several documents. Specifically, the following definitions are still to be specified in O-RAN:

Security logs contents (payload)

Security logs transfer mechanisms

Security logs formats/schemas

Security mechanisms applied to protection of the logs at rest and in transit, i.e., confidentiality, integrity and access control mechanisms shall be considered.

The requirements and solutions specified in this Work Item should support the compliance with regulations and industry standards with respect to Security Log Management.

In addition to the normative work, this Work Item should support the implementation of security monitoring use cases with recommendations to O-RAN infrastructure operators.

The following diagram shows the building blocks of O-RAN architecture from the viewpoint of Security Log Management:

Figure 1 - Security Log Management Schema

Scope

The present document considers the security log management as far as it applies to entities defined in the O-RAN architecture.

Taking into consideration the threats and risks identified in O-RAN Threat Model specification [1], the study analyzes a list of key issues on Security logs contents (payload), Security logs transfer mechanisms and Security logs formats/schemas and proposes solutions in order to derive security requirements, intended to be part of O-RAN Security related Specifications.

References

Informative references

References are either specific (identified by date of publication and/or edition number or version number) or nonspecific. For specific references, only the cited version applies. For non-specific references, the latest version of the referenced document (including any amendments) applies.

NOTE:	While any hyperlinks included in this clause were valid at the time of publication, O-RAN cannot guarantee their long term validity.

The following referenced documents are not necessary for the application of the present document but they assist the user with regard to a particular subject area.

[1] O-RAN ALLIANCE, “O-RAN Security Threat Modeling and Remediation Analysis 4.00”, July 2022

[2] O-RAN ALLIANCE, “O-RAN.SFG.O-RAN-Security-Requirements-Specifications 4.0”, July 2022

[3] O-RAN ALLIANCE, “O-RAN.SFG.O-RAN-Security-Protocols-Specifications-v04.00”, July 2022

[4]	https://devopscube.com/kubernetes-logging-tutorial/

[5] https://docs.openshift.com/container-platform/4.10/logging/cluster-logging.html

[6] https://www.ibm.com/docs/en/cloud-private/3.2.0?topic=guide-audit-logging-adoption

[7] ETSI GR NFV 003 V1.5.1 (2020-01)

[8] Role-based Access Control (RBAC), https://csrc.nist.gov/projects/role-based-access-control

[9] https://kubernetes.io/docs/concepts/cluster-administration/logging/

[10] Open Web Application Security Project (OWASP), https://owasp.org/

[11] OWASP Logging Guide, https://owasp.org/www-pdf-archive/OWASP_Logging_Guide.pdf

[12] NIST SP800-145, The NIST Definition of Cloud Computing

[13] ISO/IEC 17789:2014, Cloud Computing - Reference Architecture

[14] NIST SP 800-92, Guide to Computer Security Log Management

[15] OSI Reference Model, ISO Standard 7498-1

[16] IETF TCP/IP Protocol Suite

[17] Guide to Storage Encryption Technologies for End User Devices, NIST SP800-111

[18] ENISA – NFV Security in 5G - Challenges and Best Practices

https://www.enisa.europa.eu/publications/nfv-security-in-5g-challenges-and-best-practices

[19] Viewing system event information in an OpenShift Container Platform cluster

https://docs.openshift.com/container-platform/4.9/nodes/clusters/nodes-containers-events.html#nodes-containers-events

[20] Kubernetes Monitoring, Logging, and Debugging

https://kubernetes.io/docs/tasks/debug/

[21] Docker - Audit logs

https://docs.docker.com/docker-hub/audit-log/

[22] Vmware - Audit Logging

https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.security.doc/GUID-9BBC8AA0-4533-4943-AEF5-6A8BC64D7A5D.html

	[23] Openstack - Monitoring and logging

	https://docs.openstack.org/security-guide/monitoring-logging.html

	[24] The MITRE Corporation, “MITRE ATT&CK® Containers Matrix”, Accessed on 03 AUG 2022, https://attack.mitre.org/matrices/enterprise/containers/

	[25] Linux Foundation, “ONAP Documentation”, Accessed on 03 AUG 2022, https://docs.onap.org/projects/onap-vnfrqts-requirements/en/latest/Chapter4/Security.html

	[26] 3GPP, TS 33.117 v17.0.0

[27] OWASP Foundation, OWASP Cheat Sheet Series, “Logging Cheat Sheet”

[28] “Security Logs Standard: NOCH IMMER EINE UNGEKLÄRTE FRAGE”: https://www.scip.ch/?labs.20180315

[29] O-RAN Alliance, “O-RAN.WG1.O-RAN-Architecture-Description-v07.00”, July 2022

[30] O-RAN ALLIANCE, O-RAN-WG11.AppLCM-Security-TR-v01

Definitions and abbreviations

Definitions

For the purposes of the present document, the following terms and definitions apply.

Abbreviations

For the purposes of the present document, the following abbreviations apply.

API				Application Programming Interface

AI/ML	Artificial Intelligence/Machine Learning

CP	Control Plane

CPU	Central Processing Unit

(D)DoS	(Distributed) Denial of Service

DTLS				Datagram Transport Layer Security

eNB				e NodeB (applies to LTE)

E2SM	E2 Service Model

FCAPS	Fault, Configuration, Accounting, Performance, Security

FM	Fault Management

GDPR	General Data Protection Regulation

gNB	g NodeB (applies to NR)

GUI	Graphical User Interface

HDD	Hard Drive Disk

HW	Hardware

IaaS	Infrastructure as a service

IDS	Intrusion Detection System

IP	Internet Protocol

IPS	Intrusion Prevention System

IPsec	Internet Protocol Security

JWS	JSON Web Signature

JWT	JSON Web Token

LCM	Life-Cycle Management

MEC	Multi-access Edge Computing

MIMO	Multiple Input Multiple Output

Near-RT RIC	Near-real-time RAN Intelligent Controller

NIB	Network Information Base

Non-RT RIC	Non-real-time RAN Intelligent Controller

NTPv4	Network Time Protocol version 4

O-CU	O-RAN Central Unit

O-DU	O-RAN Distributed Unit

O-RU	O-RAN Radio Unit

OS	Operating System

OSI	Open Systems Interconnection

OWASP			Open Web Application Security Project

PII		Personally Identifiable Information

PaaS	Platform as a service

PM	Performance Management

PNF	Physical Network Function

QoS	Quality of Service

QoE	Quality of Experience

RAN	Radio Access Network

RBAC	Role Based Access Control

RB-RBAC	Rule Based RBAC

RIC	RAN Intelligent Controller

R-NIB	Radio-Network Information Base

RRM	Radio Resource Management

SaaS	Software as a service

SBA	Service Based Architecture

SDL	Share Data Layer

SIEM	Security Information and Event Management

SMO	Service Management and Orchestration

SOC	Security Operations Center

(S)RAM	(Static) Random Access Memory

SSD	Solid State Disk

SW	Software

TCP/IP	Transport Control Protocol / Internet Protocol

TLS	Transport Layer Security

UE	User Equipment

UE-NIB	UE-Network Information Base

UP	User Plane

VM	Virtual Machine

VNFC				Virtual Network Function Component

Secure Log Management background, concepts and assumptions

Introduction

Figure 41 depicts one possible log-management architecture for VM-based or containerized implementation and introduction of SIEM. The figure attempts to describe the log-management architecture on an abstract level, independent to whether the implementation is physical, VM-based or containerized. The figure has been created based on different sources (see [4], [5], [6], and [9]).

Figure 41 Log-management architecture

The Cluster-Node is maintaining the VM-based and/or containerized product applications. These applications run as virtual network function components (VNFCs). (Refer to ETSI GR NFV 003 V1.5.1 (2020-01), [7]).

The perimeter of a single tenant = trusted environment is represented by the Cluster-Node. The term trusted environment implies that any piece of SW that is up and running has been verified, either during boot process and/or during systems run-time.

From log-management viewpoint, three different types of log-files are considered, these are the ‘normal’ application-level (normal-logs), the authentication-level (audit-logs), and the OS-level logs (system-logs). Each log-data is (logically) interfaced to a log-agent. The log-data is pushed to the log-agent, further, the log-agent is filtering for the relevant information and is providing this information to the log-collector. The log-collector is (logically) interfaced to every log-agent and is receiving the log-data. The log-collector scheduler is for push/pull of logs from/to the log-agents. The log-collector is providing the log-data to a log-data repository, which can then be accessed by a graphical user interface (GUI) for data visualization. The log-data will also be provided to the security information and event management (SIEM). The SIEM is a data aggregation tool. The aggregated data could be used for intrusion detection systems (IDS) and subsequent for intrusion prevention systems (IPS).

Definition of Asset:

The term asset in this context refers to what is of worth to log-management and needs to be protected.

The entire log-management function and the log-data represent the asset. Therefore the log-management function and the generated log-data must maintain confidentiality and integrity at rest and in use. For the definition of the security for the log-data in motion, the log-data server can be either standalone or can be part of the O-DU/SMO server. The lower layers (refer to TCP/IP [16] or OSI [15] networking model) are providing support for the confidentiality, integrity, and authentication protection of log-data in motion.

Figure 42 Definition of Asset

The log-management as a function is creating log-data. For log-data that stays within the Trusted Environment, the log-data security applies to in use and at rest. For log-data that leaves the Trusted Environment, the log-data security applies to in motion.

Definition of Event Sources

The NIST cloud model is defining, among other things, cloud services, specifically Software as a Service (SaaS), Platform as a Service (PaaS), and Infrastructure as a Service (IaaS). For a more detailed description please refer to NIST SP800-145 [12].

The definition of cloud computing activities is as specified by ISO/IEC 17789:2014 [13].

Each of the cloud service is creating own log-data.

Physical Devices

IaaS

PaaS

SaaS

application-logs

(incl. normal-logs)

App

N/A

N/A

App

Audit-logs

App

App

App

App

System-logs

(incl. Cluster components-logs, Journal-logs)

App

App

App

N/A

Developer-logs

App

App

App

App

Table 1: Cloud Services vs. Event Sources (Overview)

Legend: App = Applicable, N/A = Not Applicable

Application-logs (normal-logs), refer to log-data that has been created by the application SW which is running on top of the cloud infrastructure.

Audit-logs, refers to Audit records that contain security event information such as successful and failed authentication attempts, file accesses, security policy changes, account changes (e.g., account creation and deletion, account privilege assignment), and use of privileges ([14]).

System-logs, refer to cluster-node level logs. Typical log-sources are VNF components and/or journal-logs.

Developer-logs, refer to log-data that has been created during product development. The log-data typically include development specific information which can be used for troubleshooting and debugging purposes.

Security Log Data Lifecycle Management

The security log data lifecycle management include the following:

The log-data generation refers to the creation and the collection of the log-data. The collection includes the filtering of log-data, i.e., which log-data to be stored and which not. This includes the classification of the log-data, specifically labelling of the log-data.

The log-data at rest refers to the storage of log-data inside non-volatile memory (e.g., HDD, SSD, …) ([17]). This includes the security controls for confidentiality and integrity protection of log-data, which is stored local and/or remote inside some repository/backup memory. This includes the tamper protection of log-data, and proper access controls to avoid unauthenticated access to sensitive log-data.

The log-data in motion refers to the log-data transfer, i.e., moving data between compute nodes and over a data network. This includes the security controls for confidentiality, integrity, and peer-mutual authentication protection. This includes the consideration of regulatory requirements related to privacy, i.e., general data protection regulation (GDPR) valid regulatory for handling of privacy related data within European Union.

The log-data in use refers to log-data stored in volatile memory (e.g., (S)RAM, memory caches, CPU registers). The main purpose of log-data in use is for the analysis and auditing.

The log-data disposal refers to the retirement (end-of-life) of log-data. This includes the time when log-data is not needed any longer and therefore can be permanently deleted. This includes the sanitisation of the storage media.

Key Issues

Introduction

This clause details the key issues identified for security aspects related to Security logs contents (payload), Security logs transfer mechanisms and Security logs formats/schemas. Each key issue defines the background to the issue, defines the threats related to the issue and proposes requirements that resolve or mitigate the key issue.

Security logs contents

Key Issue SLC#1: Logging all Security related activity and events.

Key issue detail

Logging is an integral part of any defense-in-depth strategy. The logging of specific events makes it possible to detect adversarial behavior. O-RAN comprises many different technologies that present an adversary with a large attack surface. Therefore, multiple events originating from the network and application layers should be logged. In addition, events generated dealing with data access, accounts and identity, and security mechanisms should also be logged. Aggregating these events is necessary to develop effective analytics that will detect adversarial behavior.

Security threats

The following is a selection of threats applicable to O-RAN that have potentially loggable events. These threats have been selected from the references O-RAN Security Threats [1] and ATT&CK™ Containers Matrix [24]..

Adversaries may abuse a container administration service to execute commands within a container [24, T1609].

Adversaries may build a container image directly on a host to bypass defenses that monitor for the retrieval of malicious images from a public registry [24, T1612].

Adversaries may deploy a container into an environment to facilitate execution or evade defenses [24, T1610].

An adversary may rely upon specific actions by a user in order to gain execution [24, T1204].

Adversaries may break out of a container to gain access to the underlying host [24, T1611].

Adversaries may exploit software vulnerabilities in an attempt to elevate privileges [24, T1068].

Adversaries may search compromised systems to find and obtain insecurely stored credentials [24, T1552].

Adversaries may attempt to discover containers and other resources that are available within a container’s environment [24, T1613].

Adversaries may implant cloud or container images with malicious code to establish persistence after gaining access to an environment [24, T1525].

Adversaries may abuse task scheduling functionality to facilitate initial or recurring execution of malicious code [24, T1053].

Adversaries may abuse a container administration service to execute commands within a container [24, T1204].

Altering a machine learning model (System manipulation and compromise of ML data confidentiality and privacy) [1, T-ML-02].

An attacker exploits insufficient/improper mechanisms for authentication and authorization to compromise O-RAN components [1, T-O-RAN-06].

Attacks from the internet exploit weak authentication and access control to penetrate O-RAN network boundary [1, T-O-RAN-03].

An attacker bypasses authentication and authorization [1, T-rAPP-04].

An attacker can exploit the improper/missing authentication weakness on SMO functions [1, T-SMO-01].

 Insecure channels with images repository [1, T-IMG-02].

Weak orchestrator configurations, access controls and isolation [1, §5.4.2].

Misuse of a VM/CN to attack other VM/CN, hypervisor/container engine, other hosts (memory, network, storage), etc. [1, §5.4.2].

Spoofing and eavesdropping on network traffic to access all O-RAN network data processed in the workload [1, §5.4.2].

Poisoning the ML training data (Data poisoning attacks) [1, T-ML-01].

Transfer learning attack [1, T-ML-03].

Potential security requirements

The following list of events are recommended to be logged.  These events pertain to the network management and orchestration functions of O-RAN and not the radio parameters. The references 3GPP 33.117 [6] and VNF Security Events [5] list security events to log and have been reiterated here for the convenience of the reader. The references O-RAN Security Threats [7] and ATT&CK™ Containers Matrix [4] list threats so logging events have been extrapolated from those sources.

Log Network Events (including physical and virtual) such as:

Network connections, port down/up, packets over limit from firewall (see 5.2.1.2.20) [25, R-94525] [26, §4.2.3.6.1].

Changes to network configurations (see 5.2.1.2.20) [26, §4.2.3.6.1].

Changes to system configuration (see 5.2.1.2.20) [6, §4.2.3.6.1].

Resource usage, shortages, system crashes, reboots, and shutdowns [26, §4.2.3.6.1].

Log Application Layer Events to include Virtual Network Function and Container Operations such as:

Lifecycle events, e.g., service creation/deletion/stop/start (see 5.2.1.2.18 and 5.2.1.2.19).

Container and OS level administration services activities and executed commands.  (e.g., Build requests, Runtime commands) (see 5.2.1.2.1 and 5.2.1.2.2).

Image registry events (e.g., additions or modifications) (see 5.2.1.2.2 and 5.2.1.2.17).

API calls (such as: system calls, those that deploy containers, discovery API, etc.) (see 5.2.1.2.3, 5.2.1.2.4, 5.2.1.2.5, 5.2.1.2.6, 5.2.1.2.7, 5.2.1.2.8, 5.2.1.2.9)

Creation of scheduled jobs (see 5.2.1.2.10).

Maintenance activity undertaken, recording whether maintenance was preventive or corrective [26, §4.2.3.6.1].

Change notifications [26, §4.2.3.6.1].

Log Account and Identity Events such as:

All successful and unsuccessful authentication attempts, e.g., logins, to include maximum retries alert (see 5.2.1.2.13, 5.2.1.2.14, 5.2.1.2.15 or 5.2.1.2.16) [25, R-55478] [26, §4.2.3.6.1].

Successful and unsuccessful creation, modification, or deletion of user accounts or their privilege levels [25, R-07617] [26, §4.2.3.6.1].

All successful and unsuccessful authorization attempts to create a session, initiate a transaction, or assume an elevated privilege (see 5.2.1.2.13 and 5.2.1.2.15)[25, R-54520] [26, §4.2.3.6.1].

Termination of sessions, transactions, and downgrade in privileges.

Change of group memberships [26, §4.2.3.6.1].

Creation, modification, or deletion of identities; and transactions executed by users in applications.

Anonymous requests.

Log Data Access Events such as:

Successful and rejected system or data access attempts such as database queries, read or writes to files and read or writes to learning models (see 5.2.1.2.12., 5.2.1.2.21, and 5.2.1.2.22).

The addition, deletion, or modification of files (see 5.2.1.2.9).

Types of files accessed.

Log Security Events such as:

Starting and stopping of security logging [25, R-13344].

Activation and deactivation of security software (e.g., malware protection, DLP or IDS).

Use of privileged rights or powerful utilities.

Cryptographic operations

Key Issue SLC#2: Log Authentication Attempts

See clause 5.2.1

Key Issue SLC#3: Log Encryption Configuration Information

Key issue detail

Security threats

Potential security requirements

Key Issue SLC#4: Logging accesses to personal data

Key issue detail

No traceability (logging) of access to personal data.

Security threats

Potential security requirements

Key Issue SLC#5: Logging Events Related to the Master Clock

Key issue detail

Security threats

Potential security requirements

Key Issue SLC#6: Logging details of xApps

See clause 5.2.1

Key Issue SLC#7: Logging details of rApps

See clause 5.2.1

Key Issue SLC#8: Logging details of VNF/CNF

See clause 5.2.1

Key Issue SLC#9: Logging information of dynamically loaded libraries

Key issue detail

Security threats

Potential security requirements

Key Issue SLC#10: Logging accesses to ML training data

See clause 5.2.1

Key Issue SLC#11: No differentiation between M2M and human interfaces

See clause 5.2.1

Key Issue SLC#12: Logging the identity of the person or process that originated the request, response, or the entity that originated the log message in the metadata

See clause 5.2.1

Key Issue SLC#13: Maintaining unique system references in the logs

Key issue detail

Security threats

Potential security requirements

Key Issue SLC#14: Synchronisation of logs using common time sources

See clause 5.2.1

Key issue SLC#15: Emergency calls related logs

Key issue detail

Security threats

Potential security requirements

Key issue SLC#16:  Logging details of O-Cloud

Key issue detail

	The continuous security of O-Cloud software (running VNFs/CNFs, Hypervisor/Container Engine, Host OS, control management, NFO/FOCOM) depends on the ability to identify attacks and reconstruct them. The earlier operators identify suspicious behavior and possible attacks, the faster they can initiate countermeasures. In the best case, they are able to stop attacks severe before harm is done. In the worst case, they at least are able to reduce the attacks severity and collect important details on the attack itself. This knowledge is important to find and fix flaws and vulnerabilities to prevent similar attacks in the future. Therefore, a key activity is to perform logging, monitoring and alerting.

Security threats

REF: [1] §5.4.2, [18] CH-V10 - Security logs troubleshooting failure

Potential security requirements

	Any change to the O-Cloud components should be logged as a security event, and the logged event must include the identity of the entity making the change, the change, the date and the time of the change.

	Security logs should be time synchronized and regularly scanned for events of interest.

	Logs should be transferred to a log management platform outside O-Cloud to maintain their integrity and remove the risk of tampering.

	O-Cloud should secure and protect logs both in-transit in terms of integrity/authenticity and at rest in terms of integrity/availability.

	Such O-Cloud security events to be logged include:

	The presence or loading of known vulnerable software that adversaries may drop and exploit to execute code in kernel mode.

	The deployment of suspicious or unknown App/VNF/CNF images in the O-Cloud platform.

Interactions with images and VMs/Containers by users to identify ones that are added or modified anomalously. Changes is detectable by monitoring the VL (Virtualization layer) and the management platform audit logs. Logs provides insight into API calls including those that deploy VM/Containers.

	The change of VMs/Containers and O-Cloud configurations.

	Actions that could be taken to gather information about O-Cloud, including the use of discovery API calls by new or unexpected users.

	Resource creation, modification, or deletion for detecting misuse of the O-Cloud.

	Resource usage to determine anomalous activity associated with malicious hijacking of resources such as CPU, memory, network, and graphics processing resources.

	Attempts to escape from a privileged VM/Container to the underlying host and hardware.

	Any missing security patches.

	Activities related to the management and use of certificates and keys installed in O-Cloud (e.g., TLS certificates and keys). All operations should be logged such as view/list, renew, export, import, modify or delete commands.

	All cryptographic operations carried out within O-Cloud should be logged such as signature, encryption/decryption, hashing, key generation, key destruction.

	More details on events that should be logged in the VL and the management platform are provided in [19] for OpenShift, [20] for Kubernetes, [21] for Docker, [22] for Vmware and [23] for Openstack.

Security logs transfer mechanisms

Key Issue SLTM#1: Secure Storage at Rest

Key issue detail

Security threats

Potential security requirements

Key Issue SLTM#2: Study Security Logging best practices of ONAP Project

Key issue detail

Security threats

Potential security requirements

Key Issue SLTM#3: Secure transfer protocols

Key issue detail

Security threats

Potential security requirements

Security logs formats

Key Issue SLF#1: Standardized logging metadata to support security analytics

Key issue detail

The intent of this key issue is not to define a logging format. There are many existing logging formats [28], and despite the selection of a logging format, many of the analytics tools presently are very flexible and support multiple formats. Instead, this key issue specifies that logged security event messages require additional detail referred to as event attributes to enable effective security analytics. Event attributes should indicate the time, location, source, and event type [27] (see Figure 3). An analytics engine can use these event attributes downstream to identify adversarial operations within the O-RAN environment.

Event attributes typically include a field to indicate the event type. However, the event type field has been omitted since the scope of this technical report is limited to only security events. Thus, the field would have just been a static value.

Logged Security Event

Event Attributes

Time

Location

Source

Security Event Message

Figure 3 – Security Event Entry

Security threats

As adversaries operate within an environment, they will generate many log events. Therefore, a correlation of these log events will be necessary to detect adversary behavior. For successful correlation, it will be essential for log events to have event attributes as specified in Figure 3.

Potential security requirements

The following event attributes should be included with every logged security event.

Time Event Attribute:
The date and time should be included with every log entry. This will allow for correlations and time series analysis of security events.

The format of the date and time should be standardized. ISO 8601 is an example of such an appropriate standard.

Precision for the time component should be at least to the second. Precision to the millisecond may be considered for near-real-time and real-time events.

Location Event Attribute:
The location refers to what VM, VNF, PNF, code module, or communication exchange the security event was generated. With location information, log correlation will allow for tracing adversary movement across the O-RAN architecture or alerting a SOC to monitor a specific O-RAN component more closely. Depending on the context for which a security event is logged, one of the below items may be a suitable reference for the location event attribute.

O-RAN function name (e.g., O-DU, O-RU, O-CU, Near RT RIC, etc.).

The O-RAN interface name (e.g., A1, O1, O2, etc.) if it is an inter-function communication.

The source IP address and destination IP address if it is an inter-function communication.

Applications Identifiers (app IDs) for xApps and rApps.

VM or Container names.

PNF names.

Code module or function name.

Source Event Attribute:
The source refers to the person, process, or service that is the cause of the security event. Depending on the context for which a security event is logged, one of the below items may be a suitable reference for the source event attribute.

Source IP address.

User identity if known.

UE associated identifiers as specified in [29, §4.5]

Key Issue SLF#2: Logging the field “date/time” in the metadata of the security audit logs.

See clause 5.4.1

Key Issue SLF#3: Standardized logging format

See clause 5.4.1

Log Management Security Framework

5.5.1 Key Issue LMSF#1: Trusted Environment for Cluster Node

5.5.1.1 Key issue detail

The VNFC is up and running (instantiated) and is creating entries into the log-files. Security professionals will use log-entries for forensic analysis in case of a security event, therefore any piece of SW (VNFC) that is going to be executed must be verified. The verification is ensuring that at time of verification the VNFC has not been altered. The verification could be at boot-time and/or during run-time. On lower layers the physical devices, as such, create log-entries, which also need to be taken into consideration.

5.5.1.2 Security threats

The attacker is running unauthenticated VNFC.

5.5.1.3 Potential security requirements

Secure boot and/or Trusted boot.

5.5.2 Key Issue LMSF#2: Trusted Environment for Log-Data Repository

5.5.2.1 Key issue detail

The log-data repository has stored audit-logs and normal-logs. Some of the logs might include sensitive information, and some other log-data might be from different owners/tenants. Access controls need to be implemented, and the permission for changes is assigned to privileged users.

5.5.2.2 Security threats

Users gain unauthenticated access to log-data stored in repository.

Unauthorized users granted read/write access to log-data stored in repository.

Users remove log-entries and/or log-data stored in repository.

5.5.2.3 Potential security requirements

Enforcement of user access controls (identity management)

Enforcement of confidentiality and integrity protection of log-data

5.5.3 Key Issue LMSF#3: Log-Data Lifecycle Management

5.5.3.1 Key issue detail

The log-data lifecycle management is defined inconsistently across the different lifecycle phases.

5.5.3.2 Security threats

Editor’s Note: Adding the whole Log-Data Lifecycle as a key-issue, is just to get reviewed every phase, and from that to identify potential (new) security threats.

5.5.3.3 Potential security requirements

Definition of a Retention Policy per Tenant.

5.5.4 Key Issue LMSF#4: (D)DoS to Log-Data Management

5.5.4.1 Key issue detail

Security events will be documented in (tracked by) log-data. Every security event is creating at least one log-entry. Every log-entry is filling-up the log-data. Finite memory space for storing the log-data, consequently means size of log-data is finite as well.

5.5.4.2 Security threats

The attacker is driving (most probably wrong) actions, with the aim to trigger security events, the security events will be logged, the log-files will be overfilled. The overfilling/-loading of logging is primary aimed for hiding actions, this attack vector might also be used to drive (D)DoS for the whole systems, i.e., DoS due to VNFC processing performance leakage.

5.5.4.3 Potential security requirements

Log-data injection detection. Log-data shaping. Log-data backing-up procedures. Proper configuration of log-data management system.

5.5.5 Key Issue LMSF#5: Tampering of Log-Data

5.5.5.1 Key issue detail

Attackers/hackers attempt to access and tamper log-data with the aim to hide their actions. Access to log-data in use, at rest and in motion.

5.5.5.2 Security threats

5.5.5.3 Potential security requirements

Remote logging (log real time streaming). Replication of Log-data.

5.5.6 Key Issue LMSF#6: Authenticated Timestamping and Log-Data

5.5.6.1 Key issue detail

The timestamping is the essential part of log-file-reviews, i.e., after a security event the security professionals try to reproduce who was doing what and when. The time stamping is helping to reconstruct all logged security events versus and logged actions over time. The reconstruction can be over different log-files and some cases additionally over different VNFC, maybe also over different locations. Therefore, the time must be standardized across all involved system components.

5.5.6.2 Security threats

The attacker causes the clock to become out of synchronization with the other clocks in the O-RAN deployment in order to hide the sequence of security events.

5.5.6.3 Potential security requirements

Network Time Security for NTP (RFC8915), NTPv4 support (RFC5905)

5.5.7 Key Issue LMSF#7: Due Diligence - Log-Data Auditing

5.5.7.1 Key issue detail

The log-data creation and provision to log-data repository is primary used as input to detective controls, like detecting an unauthorized use of, or attack upon a VNFC. The activation of log-management and the forensic analysis of the log-data is helpful only if security professionals perform log-data auditing regular or at least at security event notifications.

5.5.7.2 Security threats

Every undetected attack attempt increases the risk of a successful attack on the O-RAN deployment.

5.5.7.3 Potential security requirements

Definition of checklist for log-data auditing. Definition of log-data auditing process.

Mitigations and Solutions

Introduction

This section contains any potential Mitigations or Solutions that may be used to address or reduce the risk associated with Key Issues identified in section 5.

Solution #1:

Introduction

Solution details

Evaluation

Conclusions

Key Issue Solution Mapping

Security logs contents

This document currently contains 14 key issues and x solutions proposals to address or reduce the risk associated with the key issues. A mapping of the solutions to the key issues is shown here.

Key issue

Sol # 1

Soln#2

Sol #3

Sol #4

Sol #5

Sol #6

Sol #7

Sol #8

Sol #9

Sol #10

Sol #11

Sol #12

Sol #13

KI 1

KI 2

KI 3

KI 4

KI 5

KI 6

KI 7

KI 8

KI 9

KI 10

KI 11

KI 12

KI 13

KI 14

Security logs transfer mechanisms

This document currently contains 3 key issues and x solutions proposals to address or reduce the risk associated with the key issues. A mapping of the solutions to the key issues is shown here.

Key issue

Sol # 1

Soln#2

Sol #3

Sol #4

Sol #5

Sol #6

Sol #7

Sol #8

Sol #9

Sol #10

Sol #11

Sol #12

Sol #13

KI 1

KI 2

KI 3

Security logs formats

This document currently contains 3 key issues and x solutions proposals to address or reduce the risk associated with the key issues. A mapping of the solutions to the key issues is shown here.

Key issue

Sol # 1

Soln#2

Sol #3

Sol #4

Sol #5

Sol #6

Sol #7

Sol #8

Sol #9

Sol #10

Sol #11

Sol #12

Sol #13

KI 1

KI 2

KI 3

Alignment to other studies

Application Lifecycle Management Security

The Application Lifecycle Management Security Work Item in WG11 identified security threats that could be detected by logging application life cycle events and recommended a set of application life cycle events for security logging in the technical report “Study on Security for Application Life Cycle Management” [30]. This list of events may be used to develop security analytics that have the potential to detect anomalous behaviour. These events were mapped to Key Issue SLC#1 Logging Security Related Activity and Events in order to ensure coverage of these events, and Key Issue SLC#1 was updated to account for missing application life cycle logging events.

Table 2 shows this mapping of specific application LCM events to the categories described in Key Issue SLC#1 to show coverage of the application events.

Table 2 - Application LCM Logging Events

AppLCMSec TR KI Op-3

Application LCM Event

Security Log Management TR KI SLC#1

Security Logging event

Cryptographic hash of application package

5d: Cryptographic operations

Onboarding of application packages

2c: Image registry events, addition

Instantiation of application packages

2a: Lifecycle events, service creation

Creation of app IDs (for x/rApps)

3f: Creation of identities

Changes to application configuration

2g: Change notifications

Updates to applications

2f: Maintenance activity undertaken

2g: Change notifications

Creation, modification, or deletion of identities; and transactions executed by users in applications

3f: Creation, modification, or deletion of identities; and transactions executed by users in applications.

Application resource usage (disk space, CPU load)

1c: Resource usage

Decommissioning of applications

2a: Lifecycle events, service deletion

Application API calls

2d: API calls

Recommendations

The following key issues have been agreed as contributions in O-RAN Threat Model v.03.00:

The following solutions have been agreed as contributions in O-RAN Security Requirement Specification v3.0:

History

Date

Revision

Description

11/8/2022

v01.00.00

Version 1 of Technical Report

	________________________________________________________________________________________________ © 2023 by the O-RAN ALLIANCE e.V. Your use is subject to the copyright statement on the cover page of this specification.	  52